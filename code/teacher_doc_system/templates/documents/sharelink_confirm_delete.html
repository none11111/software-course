{% extends 'base/base.html' %}
{% load static %}
{% load humanize %}

{% block title %}删除分享链接 - 教师文档管理系统{% endblock %}

{% block extra_css %}
<style>
    /* Page Header */
    .page-header {
        background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
        border-radius: 0 0 20px 20px;
        box-shadow: 0 4px 20px rgba(220, 53, 69, 0.3);
    }
    .page-header h1 {
        font-size: 2.5rem;
        font-weight: 700;
    }

    /* Warning Card */
    .warning-card {
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: none;
        overflow: hidden;
        background: white;
        max-width: 600px;
        margin: 0 auto;
    }
    .warning-card .card-header {
        background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        color: white;
        padding: 2rem;
        text-align: center;
    }
    .warning-card .card-body {
        padding: 2rem;
    }
    .share-link-info {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 15px;
        padding: 1.5rem;
        border-left: 5px solid #dc3545;
        margin-bottom: 1.5rem;
    }
    .document-icon {
        font-size: 2.5rem;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
        color: white;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        margin: 0 auto 1rem;
    }
    .btn-danger {
        background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        border: none;
        border-radius: 25px;
        padding: 0.75rem 2rem;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
    }
    .btn-danger:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(220, 53, 69, 0.6);
    }
    .btn-secondary {
        background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        border: none;
        border-radius: 25px;
        padding: 0.75rem 2rem;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(108, 117, 125, 0.4);
    }
    .btn-secondary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(108, 117, 125, 0.6);
    }
    .alert-warning {
        background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        border: 1px solid #ffeaa7;
        border-radius: 10px;
        color: #856404;
    }
    .share-link-url {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 0.75rem;
        font-family: 'Courier New', monospace;
        font-size: 0.9rem;
        word-break: break-all;
        color: #495057;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="page-header">
        <div class="container text-center">
            <h1 class="mb-2"><i class="fa fa-exclamation-triangle me-3"></i> 删除分享链接</h1>
            <p class="mb-0 opacity-75">请仔细确认删除操作，此操作不可撤销</p>
        </div>
    </div>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card warning-card">
                    <div class="card-header">
                        <div class="document-icon">
                            <i class="fa {% if object.document.file_type == 'pdf' %}fa-file-pdf{% elif object.document.file_type == 'doc' or object.document.file_type == 'docx' %}fa-file-word{% elif object.document.file_type == 'xls' or object.document.file_type == 'xlsx' %}fa-file-excel{% elif object.document.file_type == 'ppt' or object.document.file_type == 'pptx' %}fa-file-powerpoint{% elif object.document.file_type == 'zip' or object.document.file_type == 'rar' or object.document.file_type == '7z' %}fa-file-archive{% elif object.document.file_type == 'jpg' or object.document.file_type == 'jpeg' or object.document.file_type == 'png' or object.document.file_type == 'gif' %}fa-file-image{% elif object.document.file_type == 'txt' or object.document.file_type == 'md' %}fa-file-text{% else %}fa-file{% endif %}"></i>
                        </div>
                        <h2 class="mb-0">{{ object.document.title }}</h2>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-warning" role="alert">
                            <i class="fa fa-warning me-2"></i>
                            <strong>警告：</strong>删除分享链接后，该链接将立即失效，无法恢复。此操作不可撤销！
                        </div>

                        <div class="share-link-info">
                            <h5 class="mb-3">分享链接信息</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="mb-2"><strong>文档标题：</strong>{{ object.document.title }}</p>
                                    <p class="mb-2"><strong>创建时间：</strong>{{ object.created_at|naturaltime }}</p>
                                    <p class="mb-2"><strong>状态：</strong>
                                        {% if object.is_active %}
                                            <span class="badge bg-success">有效</span>
                                        {% else %}
                                            <span class="badge bg-secondary">已禁用</span>
                                        {% endif %}
                                    </p>
                                </div>
                                <div class="col-md-6">
                                    <p class="mb-2"><strong>下载次数：</strong>{{ object.download_count }} 次</p>
                                    <p class="mb-2"><strong>最大下载次数：</strong>
                                        {% if object.max_downloads == 0 %}
                                            无限制
                                        {% else %}
                                            {{ object.max_downloads }} 次
                                        {% endif %}
                                    </p>
                                    <p class="mb-2"><strong>过期时间：</strong>{{ object.expires_at|naturaltime }}</p>
                                </div>
                            </div>
                            <div class="mt-3">
                                <label class="form-label"><strong>分享链接：</strong></label>
                                <div class="share-link-url">
                                    {{ request.scheme }}://{{ request.get_host }}{% url 'documents:share_link' object.token %}
                                </div>
                            </div>
                        </div>

                        <form method="post">
                            {% csrf_token %}
                            <div class="d-grid gap-2 d-md-flex justify-content-md-center mt-4">
                                <a href="{% url 'documents:share_link_list' %}" class="btn btn-secondary me-md-2">
                                    <i class="fa fa-arrow-left me-2"></i> 取消
                                </a>
                                <button type="submit" class="btn btn-danger">
                                    <i class="fa fa-trash me-2"></i> 确认删除
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
